use std::fs::File;
use std::io::Write;
use hex::ToHex;
use bls_pedersen::bls::verify;
use bls_pedersen::data::puzzle_data;
use bls_pedersen::hash::hash_to_curve;
use ark_ff::fields::PrimeField;
use ark_bls12_381::Fr as ScalarField;
use ark_ec::{AffineCurve, ProjectiveCurve};
use ark_bls12_381::{G1Projective, G1Affine};
use ark_serialize::CanonicalSerialize;
use ark_crypto_primitives::crh::pedersen::bytes_to_bits;
use bls_pedersen::PUZZLE_DESCRIPTION;
use prompt::{puzzle, welcome};

use std::env;

fn bytes_to_bits_string(bytes: &[u8]) -> String {
  let bits = bytes_to_bits(bytes);
  let mut s = String::with_capacity(bits.len());
  for bit in bits {
      if bit {
          s.push('1');
      } else {
          s.push('0');
      }
  }
  return s;
}

fn write_msg_to_file(msg: &[u8], mut file: &File) {
  let blake = hash_to_curve(msg).0;
  let string = bytes_to_bits_string(&blake);
  file.write_all(string.as_ref()).unwrap();
  file.write_all(b"\n").unwrap();
}

fn main() {
  env::set_var("RUST_BACKTRACE", "1");
  welcome();
  puzzle(PUZZLE_DESCRIPTION);

  // Getting puzzle data
  let (pk, ms, sigs) = puzzle_data();

  // Writing data to file
  let mut file = File::create("bit_vectors.txt").unwrap();
  println!("{}", ms.len());
  for m in ms {
    write_msg_to_file(&m, &file);
  }

  // Signature to forge
  let m = b"deenz";
  let (_digest_hash, _digest_point) = hash_to_curve(m);
  // println!("{}", bytes_to_bits_string(&digest_hash));
  // 1100111011001010011000100010011011111001111111101110101100011100001001110011011100010010101000000111000111001001000100010001001101011010100101011001101011010000110000001100110010100110000111000110010110100110111010110100111000100010110010111101100011000000

  // Outputs from running the sage script - see on README.md
  let coefficient_strings = [
    "3a272f8baf2396acde9ec06687333390bdf5a08b733165adc7866e9f49a9207d",
    "3112b418cbe0035f3139ad50ec162069f27c58be2df53ed901c52efe286acca1",
    "0b6b7e7693a4746bcdcc1919eb34943c5db654e6ed8181bb7c5c2d61a798e2f5",
    "428e8a8088fdd17ba4485b89d4ff9c26a101486f28855898ab604084c479ec56",
    "47cc36c8e202c095e7db37f4f696f6aaf4923e31eb2d5738152454dd91e9490c",
    "29d0891d5d9ad03614c623f6baff4dfe8b9391c37799d7602b1f452cb53c64e0",
    "244fa4630284ba292194ffd57e1eb1089b26e91e3516bdf01303eb9bcb997a9b",
    "0f884b0e678456ec1dbf2a6f37b8162a896edea06a4087c22b60d151f93efd36",
    "72cf0943ffe171ba8672b84511de7c1dfc081d06626620b70d16d357e14cedf8",
    "22e29d8511e97ee4fafc84ba7fe9b39420fc0596ed5b029874f5025284a3a7bc",
    "207ebf009008b13a107ce783196f3565fe268ea5136534cc9702f3dfc079fe90",
    "0055ce5a30a2d361efa543f45c22316ad1149c7e8acf795a14cc0961a3dc7e15",
    "670c49ce18750e4dc56a451d286c3689ecf7088fe799956595cfdc1c8262e042",
    "0b500659e5e9512ac26e7aeaeb9cca41eae46968a40fa15b8ad33d2ab34390e9",
    "57e6c8c39873e73190b32653b2d16d0b169f1a7fb2a2800cafffb4c799fbe3c9",
    "48bce484e8a8b30fb9424f7374b6a551b191cb3b5af0b948814bff73ef0c3f3b",
    "2b59e2f6c06e809b32a14a31ff1742d459893d39e407592aa345215dc797a682",
    "2bd102f391bc86b4f5d2b76940a433771e30e59fd67a967ff4840ddd0f5c1864",
    "52dc971edf84e3a265e02a979abc453240d5591c8f63cb4a6b46e8d163775c12",
    "681d3f638ce468a2e63cff30e0b817eeb7465081f7835080b280cc4f28481ab9",
    "2e44899238920bab911062a7d902868dd231c33bfa3eeb015146e99feecec7e7",
    "60b6812093dc13ed7f928b128b2339eb077c3c7183fa53f86206c2ea60593311",
    "43eaf7f353349913adcad5599aab10419bc8fde67fedd05cd657c8a0429ed2ca",
    "3af5ec73ae830fdf8eca47acd6caec9114233a39f6a47821ac0566b0b475bbfc",
    "025cf6dd4887955bd6235fd02bdcd4c4d65f06d4bd32916285d8f440a8b779ba",
    "4f5a9a71b5ac39ada3926e4011cce86394e55068774fc77ddebb6b633d3c9809",
    "4c79115e4226bacb42ddb752331b6f514f2de73d4b289298f52859e4f8c31597",
    "23804c9d4d70f93a782053c95d27fd57c59840e9cf78e20a66107756e4094302",
    "314d3f0bf5e22c54862c98fb8110f427a087d98cb941e2270d155fd16cf9348e",
    "33a51694a5810d79307976f6451081734c73bfd3a74b434799e62aba72e21953",
    "01d2ec86da30dcdb5ce0582e637ed63b9138174844b983347cdf249e47a15151",
    "0d775ec891dd7c07630060d4da4007b1620569e1022878bba71b2e8ca31cdc18",
    "4094d54fd0daac390df3ae1d3b6ca82877dc3ff6352581be5f1d2313443674e1",
    "6af27d556c63cd808d97123ae4483a71702307edf9462448c90b7c6c40c7d667",
    "3a333bb18b3e5b38b3ecc052bad578dc07fad7a294487a58e0e9ca8df4ef10c0",
    "6e3e5a5f59e39cca690b76436d207c286066ade55ff633dd1659d46389b6ea2d",
    "73c7817bd7c97b045a9d4308aca3d84906b1387def218c561c4386cc8c346a46",
    "54868a5cbbb700cfaab7c9dbfb234945b33860bd3aad6e837374baaa0b7d0f45",
    "4a595efc2acb4ff727fe189cbf321f2e899bf5ae53c6270c7433a604e4baccf2",
    "612fd2383198f8dd1d0608a1cfa982ce9742ea50a5d89a429602395fa6696344",
    "14e9c8e26152142b06515de4a9813115af0d9b12a5628e29f4f11dae9b119e08",
    "3e1b247fdebb0b78c275d32e4dd3f7a89fdfee9051d27c6917f6fbab0215b999",
    "0b335e294bec3794aca391884e4ae558319f5cbcf148d78bd9aa9bb1aa092c61",
    "2eb0f8e3d77d892d39b7b7826b482ac238dad39a35216cca3190beffbc75c31c",
    "55fd932be3632c714df3fbecc2e16ed146a40a79d90b21aebf6fa311abf57829",
    "3e4a24a078da7e52a53bc4cea742b70a4a48c2dacb96bc573d892391bc5c38b5",
    "34be1687fb7aaebc2ac76b595eb3bb73026448c83e3be72587563460ae93c268",
    "274774edfe9e84ab3f1387d08461d7d6bf6a7cfc4389f72267ace8300153a628",
    "365c5b4bc4e42653e9f53ebba1fc88d0cf911cdcc80b406072fad4d3035b5c50",
    "02ca97954aebf792f3dbd714ab7b3017ac0fcb2b294b71b90bea796e958288b1",
    "13a3fa587edbc446eb9b34622ef3dd4c13d70dfc36c2336db5fb4a4b44a4de60",
    "0c3bf0d0a21c598f6be1808dfc8bb7f811a933de1f27fe62e93c05ae085186ef",
    "084ae5039e69fc5fae1f67022f6a8062423397ddd0df0611da8cff4bccebdd8c",
    "22de0a0712a0f15e4683ef23c2af6b5710917ff8ddc28dd9925d9420ceacde37",
    "680e85c375320abf6f3878ea3120d69aa815c2ff3e86558077c37d6745c552e5",
    "0b070d0f1e9255f5d4ea119cc0ac09d8f31f08013fcbc1854056bed0b1b2ce8f",
    "11eaab640f1de6e92dcd1d42b42ae2a1d4b507abda1515dcf3129a7391071d0e",
    "4a49a8364a35d2c7a9c9dd7f274d087674cb4aea20a72a38d2585e0adfb111b4",
    "44ab0886b57d357eb744cfe12e079229ae534f67815a864702882967bbd04052",
    "312fe13916baa5f57aa8d7983c77ed64562406eccb4a8f4ba79f96a410b2eaef",
    "4428154cb740d7fe4398b477a02a3edbdc110f3aba5b9b731774d7fb3b9bdb3a",
    "2c9c115f07049e78a443e3b17412999f16bdaced74a08725dae197a9ab4b3e62",
    "729fea7e8bd58e10a6de39c2f9fcdedc5b499cd236ebeffcf84b91070cbb57ab",
    "23285e47d4cf1a68ea3c5896a0e418f170c1e8aff890cc860f66b52cca4c2b23",
    "547c7de4ec89dbbde6c114d0867dec412a90e64976251e409cd8133975a05f81",
    "0def9b4fc50aa14a82e16267eccc39e77b42623110df11616819b38b89961959",
    "51aebfeea2c30b4fa9c93730ad832e9aa22169738aedff11b984a00991d74bfd",
    "5d003fbd2c87c81f4819297b0b465ef255747811be548ba66b6acc92c29cd9f4",
    "0e59c42f0f2e52b1b4a6007303be0698d958d21b4d321392b2ef83d239fab144",
    "404238af626627f1c69dea7caa16d9f5c9e9ebca775ee97d1865756150f4f496",
    "3f2e72eb0726fe155704159a02d9ab86fe860fd3a5a246e1047d4d741fd0390c",
    "4a029fc468768b0222b35490ee7eaf53354f6dc578429c96d7a04c38562980d2",
    "01e31f69e07dc286a8eb1640a581719e34e20c5bc14a7e6b9bc4cea7f81f94b5",
    "10f3c72f5ad6930d8b7cf10401f1025685b501db915384e8c407e4dce24a8eba",
    "04dbfc9f831a14366c85de9ab1279c5c03490f3d3f9be96112d0ac97c7cfa99e",
    "2f4ae36be1437dd0189752260144e6c7b16dcf1f87643f30f8b7c931d250ad99",
    "65f0ef89fdde2e5e2cd2582e844b12bfbdd4577777405ed565cbb839252125cb",
    "6e33a7a09ca175f498a719775fe9b3d7d8f4a19e2103916d56bae737f8c8bfb7",
    "1050529990d8a08b6cd516c4d3a87a918beec4f75e0a28c2ef43a6296b0e061d",
    "5d01008e02406805202111a56c68e0495954fc53c422baee9a37befc460814c7",
    "6c4ba37ae833a1f06c1f328e5c28d5ad2f005562244ab43063d5d12f09c07de3",
    "2a7c406ad0a0c4b8ae5ef7cf2bf89a40fd83ab2270b4051c54f0181ea4ee068d",
    "3605b89d06a70335173d18eb4406e0b8dd5adb6f50f91382a9ceaed52d679477",
    "306a36cc1707e91f2e683d8f76d950b737e62aa8a2e7850ab9d8555fad14a47d",
    "0809444eb891b920327c02b96266a654fbae64291dbc57a406f0b3189e4bfac7",
    "3e63a849f4ab8fd503879c954a2b773debacf30335e5e0198a8e1aba546e21a8",
    "30d25c7f8211f1156e3b01f8b5cd3f35f64b54346b22ce2f545046d0ad6ccdd2",
    "2904635e1f8c67241f7a96bcb61928fbee7e4d38c29edf7c835d80d0af76f305",
    "0d13cbe03faadcb39987b9749dd4aa7bdae173bb5eb079bb5993d81a0b494f38",
    "2bb6dc94ce415d0d65b5e570191a076f5f60eab1695df65d5d6069fc9417f009",
    "48c4add41501c3fd0c39690907bfbefb7a08c29d0225fb4acaa151f1882d13bf",
    "64273c5438cf9e30bd7c3d629fc53135a673bfc825253b8c5e88197389f0f2b2",
    "36484e0f402c62ac489df7d6512a2f854428b46a6e0c919cede07f5df80a9827",
    "6449534fccfdc9c7acb0abb2f376425fb4b6d7529fba70a77c19979e79d7c5cb",
    "7188f7b405bc98278d1b82e0d89559eede7337e6af231ebe3830b4480e32d804",
    "2477fd0b2530b94d961c3d83f702e3908a0fbfb1bb09258e8e3e2d0cff89a56e",
    "1aae67be1bc781484da1724399d22eb5eb58dc59eef982a243a8a014c42a4073",
    "3ea04d4b7032641e7d044c020fd66f0c2a4318c8e76da99ced247a8f0cce6175",
    "1848283e7183c5c3d2e439f6291de90aa34c208a6b0cf18dc5b85768358d116a",
    "2823dd904f50d8e9e2f12030d276e967dba1404a2a38aba4c23e0722b6599310",
    "2ec7ff9f06f167aea2836ee1f85e31d8e5c9fab485b2fc5d2fec7280f52ad1ae",
    "17f75ed7b6dc613a14f61e6f93e4ce61ef10cef16d6c05a3c4bfc4ddb75f6df3",
    "646578642ab09eb4efbed233f17ba99d90c62be04ed8d3a2c61187a2a04bd453",
    "1d363129ed526bb22cd9aa91de61f50c951b16ae7a4cd83d20ba4f65285f85d5",
    "2e6419f4e1e72a6eb9ab6e738d892982b3b8a4537df8072b1948011f14ef0bec",
    "426cb5d310f751b987af679136e154171731f96f1596f81acab5f8730e095d54",
    "5378eadae9e28117bc8e1620ac18e6c30e83f63bf727dbe03ab2f7051bef88cc",
    "4c41777829627a245dd0069f8de1dc332ea94713d1a190ab8a07c75200f1a744",
    "717ebd7dbca142e744f02b885152fc1e9e8deef7513b5aafcd4bc54af1db159d",
    "277baab7f5f51e0e9a2c75e7cf251eda66f584d82f7b4d9327e0e85ee1c69544",
    "2095fc8cfc5b817b2f541ca5016ad58e907739c3feaad82a9783645169677c2f",
    "7280c5fbb874243cdcf6e7d030e498c409e774466bf98ce88d3270ce009712b9",
    "174ad1fd378de94b1d1ada223aa19d77c50fa83be83cb063026a08a3a0629fc4",
    "4ce3c1a86246b11a035189269ffa3c8c5e2a210731634ee3ee0df236a624ca8a",
    "51b17e33877db157f9fa8166d724b8f4c1f22f83129b00464c9ca7a53230016f",
    "02b25b182cd5a95043650a8de81567f81e4aecc5a284be2bd6ea7ec9f3cb7603",
    "50595f00176081d9322db4c2a3245be8fe978b68120f793825e6e1a2ce7a371f",
    "1b04f08476d648900358106cc087a239ddbc647ba44c15c96c7433917d2ece56",
    "1fa35a1be6b87ddc25a13a969af7fca01cd4db2c3466cafa1dbb6a1129d6e982",
    "2f134cbede54aac97046f092e58284ded3893bb022e676d0dbdf31eea4019b1f",
    "36f40cf64ad44a08de1cb14f8b5359606e3b8b080931fcf41254714b697652e6",
    "4407d6989704413bb27772c344c3f015f41c4d6a51bbf1dcff3a3f678cefe057",
    "3821414987a029c506693ea7df9a24941a9a8495a0b0af679a6d53aa5e174e6b",
    "1e8f5b7bee5a46f7509a949eb67f8d445f8e4f65259b632d2e0518494e938542",
    "1778624b95f29eff44dbff233a8233e12c0eef9df437c37eb8f3797b6c104146",
    "6bfb1b61ac5700afa9ab7efa24778a96cc65e0149144da0f33787b1d2235c0f4",
    "3a5150cee5f29242a97bb7d00e92738b302ad3a9f8df786f6a0a9ceee5b91487",
    "1ceb6ed33e6beb02453baeacf1bfdd02d71ecafd7a168bc6a8ebb11203ccdfe5",
    "460911cb41ec207e82aced5b5418847a4916cf0b94e7498ce950fca9bfcc8cc0",
    "255279efd287e3c36a74d09aadcc7e9152b4a185d2049a23f26146693ca62efd",
    "4eaedf12185bfeb2eccf6e0d22046514b384b5e55773e83a76b051e043e1973c",
    "47f46e2b9aab8fee87a9a65a2d3fa31947ce1b244fdf20ada7c412e603fcfdd6",
    "39dc1f1fd939003b52f3e673c548c36a98ae7267d82d543d6d90e29825b2a1ed",
    "233bc2da4e106c8fce72c18683ee1b62d60931fece0d1428beb5ee7828f5c4b5",
    "1ef57605d54fe6bad95247102499969b5cace9fe645f3daed131dc728ac295c8",
    "35d3c434d20748049806d7c9441e7dbbcf2597c50b979a4bb36a36a0a76f884f",
    "23f5b71b45488b145a44f82b0abdcd3693ff3e1ba76425a55afdbec3d5c5921b",
    "41ccb3e5d18c70cea3a16e4949997b61628a61b8e85cf152561a98e19ddfe70e",
    "41862c46086d7f276b532ecfbac256a515eaa838dd0268826360080e05a608fa",
    "0248d4e3b1fead3a1f12d05f78b69449a1c56dc8c4b12ae00dd30efc7751f4a5",
    "2eaeb77d4a31236679dc4bf3b85276c17543d0bbdedb1c29bc4adbc7d8e2c3ba",
    "6f9353acca066f7dc59fb2a987cecc7a5265df0b032dfb0f1f6bea316e208473",
    "11bd83a15e27d3499bda09ca539dc907aeffdb9e6042693a217ae1d9736901eb",
    "67ff96504832dcec8fb46d9e3f2459e9b2736cb247207ce4d8b5810d4be18839",
    "6aaa76f8362182054457718f90d46b43c681c74c95d52438ce2fa8350905f233",
    "445e773370543d341ff3022ba25eda7d383ccf4cee5ebba3330952b168b082d0",
    "2896b904590b9814481c86193aa3950e7525cc3117731a730f26d60437ee6b2c",
    "5f19970a5cc627a0f115ea196973be076dafa3b6cda3660736399a829ff57c23",
    "51aecf55449d1b54ed06ccfd67fbb905492ebe05a3d9cf625e6ea73a3e2cb999",
    "66d7f606fb11b8b0c7b7692ac3ef221c6e7ef4292f0ceac438bcbbf8f8cae60e",
    "25b765dd8db9a29bd429347f320ab6d59cc2ac23cd7efb09505dd41cfafaeed0",
    "47331b3177c0c44b937959ba11f1d1555255826a3eb8712b8f47e605b2e169f9",
    "4c40a8265539147482d488a16a37ac2535febdbd528be19bab59adc43cfc5d83",
    "5651d457972fd7fde6016e60e3e04648962b93f427ac8b8407d3ebf0b7c9fa10",
    "0242f58e3acb072d2e35d44ec7fbd03bf360dcf64c6908048042a6ce077e4393",
    "6e009a51ddd1ba8f5f0e57ba96a3e41b4a6e0293abc5844df8820cb0143cac01",
    "18e3aba72557f265eeaa64f5adce4e7e7be550d4dc87d08897d66de371389882",
    "4270bb4aa08cacb7e0d072230fe5d4a89e81c5bd382b993c07892e6e0a648662",
    "5717fe6c6175795083e3485539015ab8742471e4b6002de800acadf75b5f941f",
    "11fd6c186888c0d0cbd2a89908810de85a692a8bc982cda99d50fc6e9ec592c3",
    "0adfc9d318fb2f93bd3df25af7c10fbe9448a6a133fe244e706f9f4ce4c173b5",
    "5103d736e97cc829c546b41b84608798d84b3a8633232e8bc8ec577753d6c0f0",
    "2ee4ea1126617822421b80f1d1b7a7b9ea0ed594c94a705b6cab212a3658c188",
    "250b938ba0189357da90d3e5474ecfad689a6bff986bebb3520c8016ae01d8bd",
    "2bc4ce4ca43a511f221f8d0984ba7cf03d63f8d30548638491a8770b30ddf68b",
    "25a3f48e3a036bdbd2e54590e3839bbb0ce6f90617c111f7daa2554008e01b52",
    "155aa9dc851d34adb0990e6d2aafbcaa439c02daa3970a0e98533b662dbed28b",
    "107c8f8a6a89fdcbac54575f2adea73f16792048d4c7797f7a63cbfbc36eb014",
    "4c963ee3f13f5c2c5e4441fddd266e7d33a488ddd926976cc9ce84b6236e87ea",
    "2eabbf61fc0aa90a0a8d1441be65b219765a1fb6eabaae855a2536140021e8ed",
    "6335bdfb1d23fb2acd3c0fa3102bfbcce3dfb38b940b9153669ebfde171ff7dc",
    "1527bb1735fb85b49d1590cf054691b5f92d79a8ef1d0a3ff7912cfe2303fefe",
    "00da9da20603c3db006ec2bfaae9c72a7ae2a0ba6da981142eaeed3f0a0fe4ab",
    "57cd0566da0a015693abf071762238ad185dd591c91e4225d308d055ef13af0c",
    "016e0de7161a08350add69d118c27f8be54ed02493431239391d8a4410a13752",
    "174135ad1e38704a9ecb069d59c8d4fb29f09914f854333e0ac4a613213acb0f",
    "27f1811a94f78ccf685030db2b475b8c2ea9f0ca99849f68fa433491bbbb08e5",
    "1ea81dd8a893cb72b6c09e92f900486f426efdc811260dd92005b7eb5065ea30",
    "739c3700c4d844598fb4f4ca557019867d17a03ffed48ee4fe2dc6a6a5c87fe2",
    "17658a6ce780a3a97788a4fa53907be4f5bf0d47bb49627209325673306fe62e",
    "17d16f99cae774139babee9a33f36210f5b718c39c3c8ad6e24b3b609794b9c6",
    "4b730c132cac88f8871f0fc9b3b7358ad7e060092a04a7cfcda6d282b1ea986c",
    "3f545abf084fdb760c4841b4c6cb6ea7e7d511b5f6338d8b0fee42af725edeef",
    "01abff1f5e708b130856d9d6f5f7b5d107b6131173cb9432e3215de2bfdcc0ea",
    "350ba69a5f13aeb09a043926d1cfbac60d7b9f1fb2efaea8ce739878f7ecb217",
    "09f08b0ad7ae5bff3afd44bba8759bab3350c6e84bc6b60c5c28168335f7214b",
    "6cfb39f66c0c3c7fa17b709034398ffe0540d55282085c9399aa22f51f6d2ba0",
    "5221d6de73457a3c505a3c2b4b2fcc0ae9754173ac491cc8476342c49efa7c13",
    "3bc81ca4c74386a56368e0fda082821e8971e715295ce53906c9c22fbcc2c752",
    "0c52331024a38dbe41596f1256b1a252de83a47582dd102ad83ca3d6a810f2fc",
    "3964e87dfcc2bdc40901b8644fabb6b511d0d65354f5169d5f4ee4b9ed9ca059",
    "15c58bcceceefd8731c002f331e67fabb00a8214a503726a4817224c34e7dce8",
    "589a30ebd74de0f07552903af334a6b9aceffeb616cf66718b25e7277062eb40",
    "0522f44a7a46e3b7b8bc8a7a7822f14118d4c31cfd9d0d6798fcdd6b2e427b63",
    "1688cde448baac27f7bf395ee9d28ecd7a91781504da38b054219c4ef446bb19",
    "61e051b8f5b4f3439c09bd49e976d5e8873df2374475227ead2528f8de8a4fdc",
    "18badb87d578d896c7c9a1f5cc8dde54927659d4ef38bfb640543dfe695170e8",
    "1a0ddfde70a6b67aa6ddb1be25fc660edb9516b6e49d51331532c4d4d4ff24bf",
    "724b8ec825b8dd61ff76ddce7ff9aa58c534d1fe584774004d10fe62c00ad9e6",
    "37957d5423745a917dbf92090e309dd76a5a4fec9051005c46aa99e9dafeba32",
    "4c8ba5458662c9998299fc7b44624f0cf0ef486eaeb306cc0d0740f4404510fa",
    "0f2f592240abc37b3f0d0ef378cd0dc02d836a3a25ccff82ba403ca5492095b4",
    "1f526fc3467d42373fa4270fcbd1efa332080a725695a355444f98edf82e13b8",
    "28ef16f32dc1e378195b2b553d1453a3dc8e369b8c187e2a5da6326b0eb18b4f",
    "0e028e87065420c89deb71c5bb432a1314736e9dced5cd7a193270d13dd403b6",
    "5e70697e66a4f97b18101f5a6b406064f71170533f1184c34401abcc6a268022",
    "54c260937f43da36fb8483fce377f9cb5032ed433d0dccc5d1af05fa228ab467",
    "48aae4465e93153785846499a3eade9a23f484066f2306d14ed5bf00ac83f01d",
    "0868131c6c211966d1d97f90d6b9660386364140a60e44ff8af02fae86a207ed",
    "42473718fd5b4cf694d9f508de23a571a2fe451d1abdd3158daeb6726df969d8",
    "73c7859882bf2abf04652650087cfa7f5efb4dbb98360af0824e64be86dcb061",
    "26c843f83641ddd4dcd6272673ea44299f83a4ebcfedf2f331fe49868f9c00e7",
    "6aea3663b9bf789c1f0a71d8856327a77b7afa123bd6bad251855ccfbefa94c1",
    "5b384c2c2f6974e35c2756b92c8fdf3f7dda3d871f390e8d0ba7b2e257993199",
    "3a9cfd09999699aa63015a47e4fc94ea44ee31f7759e86c0fa24817206e1490e",
    "2dfcd73d61c89aeba8083f5252bbda071f6b09a016b7654122b94d3ad1e1c8c6",
    "34101defbabb362fa6d505f72ab1f3deceee3841c61802dc5c5185cf8c781b74",
    "424bcc3a301e5cd2b71e1ba0fdbbd241a901a05053e3b96372dafd11cbcbb449",
    "71f9b4ef078900dba08bfdde8533e44929a398f46e789d05e43d84644c9780b8",
    "2b1f7022f211a2fab614a76274ade32f4f07d4f8143ba57d82f476aa73b83af2",
    "4fc6fbc9984d5f47a68a9b79810af244ffa64c65552e5a00e1b7aa96cd8dd2dc",
    "11451402a4418bc5ec6d434c5f82debe6c95608a608779ae8ec8f0c780c22953",
    "2e43b187f614aa78271b669a1ed5f434ba541bee20f26db9de8f1e6fc447bab1",
    "53652abfc5950ece094c8f27008a5cf2eebf1aac3fd920113d974161f8bb633c",
    "097484bffda2936212330b8e28754c29f4db4f8988c2fde94ac10205d5354794",
    "05d7da9e459521d24e28fbf7d18f819c86180be0e1734a27311462c900646187",
    "4581f93b0d0489a7665b4a5e7acf1bfb640927bf801a5f36785a0c08d6cb4847",
    "2d5279e18d4f072f00d00d1f0005f32eeee03755fb6cae5d74e57695854d4edc",
    "018c444168fa9bd232569a63d3697b7f958278cbedfb931ec44804ba7808db05",
    "496e233611c6bd290ec4dfbd9bfec05095bf041723316eacef1081b811af776e",
    "4ff61dcb612f876decde9cbee3e9ae99b6a6fe944c4f4d96d40b407f51d429d3",
    "24e09377f19f03a300ca2fa0e4db70dcf232fd823b8189e1662e2c67810b4f72",
    "172bcbe32e287a40e3ee5f48349f36d8b58a87c85d2f41251712d766fa340863",
    "618938907815b1e423528f91b88810b4108639c0c74df2d8d58f3cb6299cc308",
    "059ddf20097a5ff0110e3588a23752503badaa3bf45b2764ad48ea388eda1c03",
    "3de5570a6af8b70317b31e5ba631dd39317b7487a9a9876d88481be178d2db8c",
    "4ab90176dd124f30fc5c71293c9cbdcd64695564ec6ab1e730c4dc1c9f73718e",
    "34cfc39de2ffa6b4860829dcb49fef73f956ed22e17b1a010b3fb80106f94d04",
    "443ebc686b2e302033805c56486004f094b7f844117fedf8dbf0d53827cc8649",
    "6c6846822208234558ee8089d2112236844914c1642f056f9cb1a240fef0b415",
    "5362cb055a90bc145234e16a0ef1dc7c26b1e933c5660781de330160e8d1a820",
    "6e0cced634eac89dec1a142596e347c540245fcf1f4a9f414e9b781f14e2c334",
    "147dde3f72cedf4657078f1bac95632fb867f872edc5b9ac23192abdf1a6d062",
    "00a1beb94a1dab4a74b72f188fe52fa64399cfc02d36c37e6b83d80a9363c3d5",
    "473b199bc1896d09843b9cd093ffe787f3596a261a2d725fea6ffe995926c923",
    "14af911c29c52777561487fcbf5d777c5c8b67e61d833a41fb5607476b9bd1c5",
    "50c7ad51f53074d16357066705c3e65ddbe2c699596391f99854f473f1251ba1",
    "0fd58d00e322998b1e761b5f9b4683322defc5d89b7968a458de7cb2f87f72de",
    "70e84146f098ba7c2f80d15b6f3e93ae73bc23fa33cd56fd415f751f40a50c7f",
    "6b31deaf8bb79089eacd89a5a2672a188ab8d1ed74afb1ba2ae1f5d3b9cfa86e",
    "596f318f12b8c64ddaba9defeaa00f3869e750ecfc052d75d513124039425d02",
    "55b7d6459a658be8485d196d0230d139be89c8210c275048e349159ac9612577",
    "2d93ad08e09cddd319266ace6504e73091b47cb13ab473ed3674192b91a962aa",
    "0cc746d5d218d33589d21b441817ff7eee6b6d8af1d72bc25b530237edabb3bb",
    "396a38679e8b9d5cc79eea07df38da96eedbc445f19f28a33b1994cf32536825",
    "694a515f6ec9c2c7067a0365a13806a00f4d4ff64b6da88a07fe6083983834ef",
  ];

  // Transform these coefficients into field elements
  let mut coeffs: Vec<ScalarField> = Vec::new();
  for coeff_str in coefficient_strings {
    coeffs.push(ScalarField::from_be_bytes_mod_order(&hex::decode(coeff_str).unwrap()));
  }

  // Forging the signature as the described linear combination of known signatures
  let mut forged_sig = G1Projective::default();
  for (coeff_i, sig_i) in coeffs.iter().zip(sigs.iter()) {
    forged_sig += sig_i.mul(coeff_i.into_repr());
  }

  // Checking that it all works out as expected
  verify(pk, m, forged_sig.into_affine());  

  // print the hex-encoded signature
  let mut hexsig = vec![0u8; 48];
  G1Affine::serialize(
      &forged_sig.into_affine(),
      hexsig.as_mut_slice(),
  ).unwrap();
  println!("Forged signature = {:?}", hexsig.encode_hex::<String>());
  // d208d88420ae3706208120439e314a3dcc2937674f7139b5219af792e692d889e300929cdc919ac8e5525a429b64ed00
}
